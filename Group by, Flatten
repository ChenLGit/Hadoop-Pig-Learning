-- using nest FOREACH to get the top 3 dividends

--run from the local mode 
divs = LOAD '/home/hadoop/Documents/exercise/NYSE_daily.txt' as (exchange:chararray, symbol:chararray, date:chararray, dividends:float); 
grpd = GROUP divs by symbol; 
top3 = FOREACH grpd { 
	sorted = ORDER divs BY dividends desc; 
	top = LIMIT sorted 3; 
	GENERATE group, flatten(top); 
	};

--run from the cluster mode 
divs = LOAD '/pig/input/NYSE_daily.txt' as (exchange:chararray, symbol:chararray, date:chararray, dividends:float); 
grpd = GROUP divs by symbol; 
top3 = FOREACH grpd { 
	sorted = ORDER divs BY dividends desc; 
	top = LIMIT sorted 3; 
	GENERATE group, flatten(top); 
	};

